{"remainingRequest":"/home/quantium/labs/solana-nft-python/nft-armory/node_modules/babel-loader/lib/index.js!/home/quantium/labs/solana-nft-python/nft-armory/node_modules/ts-loader/index.js??ref--14-2!/home/quantium/labs/solana-nft-python/nft-armory/src/common/rarity.ts","dependencies":[{"path":"/home/quantium/labs/solana-nft-python/nft-armory/src/common/rarity.ts","mtime":1666703689729},{"path":"/home/quantium/labs/solana-nft-python/nft-armory/babel.config.js","mtime":1666703689725},{"path":"/home/quantium/labs/solana-nft-python/nft-armory/node_modules/cache-loader/dist/cjs.js","mtime":1666703775764},{"path":"/home/quantium/labs/solana-nft-python/nft-armory/node_modules/babel-loader/lib/index.js","mtime":1666703776480},{"path":"/home/quantium/labs/solana-nft-python/nft-armory/node_modules/ts-loader/index.js","mtime":1666703778256}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:InVzZSBzdHJpY3QiOwoKdmFyIF90b0NvbnN1bWFibGVBcnJheSA9IHJlcXVpcmUoIi9ob21lL3F1YW50aXVtL2xhYnMvc29sYW5hLW5mdC1weXRob24vbmZ0LWFybW9yeS9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy90b0NvbnN1bWFibGVBcnJheSIpLmRlZmF1bHQ7Cgp2YXIgX3NsaWNlZFRvQXJyYXkgPSByZXF1aXJlKCIvaG9tZS9xdWFudGl1bS9sYWJzL3NvbGFuYS1uZnQtcHl0aG9uL25mdC1hcm1vcnkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvc2xpY2VkVG9BcnJheSIpLmRlZmF1bHQ7Cgp2YXIgX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIgPSByZXF1aXJlKCIvaG9tZS9xdWFudGl1bS9sYWJzL3NvbGFuYS1uZnQtcHl0aG9uL25mdC1hcm1vcnkvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlciIpLmRlZmF1bHQ7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmVudHJpZXMuanMiKTsKCnJlcXVpcmUoImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5zb3J0LmpzIik7CgpyZXF1aXJlKCJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LnRvLXN0cmluZy5qcyIpOwoKcmVxdWlyZSgiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuaXRlcmF0b3IuanMiKTsKCk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAiX19lc01vZHVsZSIsIHsKICB2YWx1ZTogdHJ1ZQp9KTsKZXhwb3J0cy5wcm9jZXNzUmFyaXR5ID0gZXhwb3J0cy5SYXJpdHlDYXRlZ29yeSA9IHZvaWQgMDsKCnZhciB1dGlsXzEgPSByZXF1aXJlKCJAL2NvbW1vbi9oZWxwZXJzL3V0aWwiKTsKCmZ1bmN0aW9uIGlzUHJlc2VudChkaWN0S2V5LCBkaWN0KSB7CiAgcmV0dXJuIGRpY3RLZXkgaW4gZGljdDsKfSAvLyBtYXkgb3IgbWF5IG5vdCByZXNlbWJsZSBlcGljbmVzcyBsZXZlbHMgaW4gV29XOikKCgp2YXIgUmFyaXR5Q2F0ZWdvcnk7CgooZnVuY3Rpb24gKFJhcml0eUNhdGVnb3J5KSB7CiAgUmFyaXR5Q2F0ZWdvcnlbIkxlZ2VuZGFyeSJdID0gImxlZ2VuZGFyeSI7CiAgUmFyaXR5Q2F0ZWdvcnlbIkVwaWMiXSA9ICJlcGljIjsKICBSYXJpdHlDYXRlZ29yeVsiUmFyZSJdID0gInJhcmUiOwogIFJhcml0eUNhdGVnb3J5WyJVbmNvbW1vbiJdID0gInVuY29tbW9uIjsKICBSYXJpdHlDYXRlZ29yeVsiQ29tbW9uIl0gPSAiY29tbW9uIjsKfSkoUmFyaXR5Q2F0ZWdvcnkgPSBleHBvcnRzLlJhcml0eUNhdGVnb3J5IHx8IChleHBvcnRzLlJhcml0eUNhdGVnb3J5ID0ge30pKTsKCmZ1bmN0aW9uIGFzc2lnblJhcml0eUNhdGVnb3J5KGl0ZW1SYW5rLCB0b3RhbEl0ZW1zKSB7CiAgdmFyIHBlcmNlbnRpbGUgPSBpdGVtUmFuayAvIHRvdGFsSXRlbXMgKiAxMDA7CgogIGlmIChwZXJjZW50aWxlIDw9IDEpIHsKICAgIHJldHVybiBSYXJpdHlDYXRlZ29yeS5MZWdlbmRhcnk7CiAgfQoKICBpZiAocGVyY2VudGlsZSA8PSA1KSB7CiAgICByZXR1cm4gUmFyaXR5Q2F0ZWdvcnkuRXBpYzsKICB9CgogIGlmIChwZXJjZW50aWxlIDw9IDIwKSB7CiAgICByZXR1cm4gUmFyaXR5Q2F0ZWdvcnkuUmFyZTsKICB9CgogIGlmIChwZXJjZW50aWxlIDw9IDQwKSB7CiAgICByZXR1cm4gUmFyaXR5Q2F0ZWdvcnkuVW5jb21tb247CiAgfQoKICByZXR1cm4gUmFyaXR5Q2F0ZWdvcnkuQ29tbW9uOwp9CgpmdW5jdGlvbiBjb3VudEF0dHJpYnV0ZXMoZmlsZXMpIHsKICB2YXIgY291bnRlckRpY3RzID0ge307CgogIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihmaWxlcyksCiAgICAgIF9zdGVwOwoKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgdmFyIGYgPSBfc3RlcC52YWx1ZTsKICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBmLm1ldGFkYXRhRXh0ZXJuYWwuYXR0cmlidXRlczsKCiAgICAgIGlmICghdXRpbF8xLmlzSXRlcmFibGUoYXR0cmlidXRlcykpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvcjIgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihhdHRyaWJ1dGVzKSwKICAgICAgICAgIF9zdGVwMjsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3IyLnMoKTsgIShfc3RlcDIgPSBfaXRlcmF0b3IyLm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBfc3RlcDIudmFsdWU7CiAgICAgICAgICB2YXIgZGljdE5hbWUgPSBhdHRyaWJ1dGUudHJhaXRfdHlwZTsKICAgICAgICAgIHZhciBkaWN0RW50cnkgPSBhdHRyaWJ1dGUudmFsdWU7CgogICAgICAgICAgaWYgKGlzUHJlc2VudChkaWN0TmFtZSwgY291bnRlckRpY3RzKSkgewogICAgICAgICAgICBpZiAoaXNQcmVzZW50KGRpY3RFbnRyeSwgY291bnRlckRpY3RzW2RpY3ROYW1lXSkpIHsKICAgICAgICAgICAgICBjb3VudGVyRGljdHNbZGljdE5hbWVdW2RpY3RFbnRyeV0gKz0gMTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBjb3VudGVyRGljdHNbZGljdE5hbWVdW2RpY3RFbnRyeV0gPSAxOwogICAgICAgICAgICB9CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBjb3VudGVyRGljdHNbZGljdE5hbWVdID0ge307CiAgICAgICAgICAgIGNvdW50ZXJEaWN0c1tkaWN0TmFtZV1bZGljdEVudHJ5XSA9IDE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICBfaXRlcmF0b3IyLmUoZXJyKTsKICAgICAgfSBmaW5hbGx5IHsKICAgICAgICBfaXRlcmF0b3IyLmYoKTsKICAgICAgfQogICAgfSAvLyBjb25zb2xlLmxvZyhjb3VudGVyRGljdHMpCgogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yLmUoZXJyKTsKICB9IGZpbmFsbHkgewogICAgX2l0ZXJhdG9yLmYoKTsKICB9CgogIHJldHVybiBjb3VudGVyRGljdHM7Cn0KCmZ1bmN0aW9uIGNhbGNSYXJpdHlTY29yZXMoY291bnRlckRpY3RzLCBmaWxlQ291bnQpIHsKICBjb25zb2xlLmxvZygnbGVuZ3RoIGlzJywgZmlsZUNvdW50KTsKICB2YXIgcmFyaXR5U2NvcmVEaWN0cyA9IHt9OwoKICBmb3IgKHZhciBfaSA9IDAsIF9PYmplY3QkZW50cmllcyA9IE9iamVjdC5lbnRyaWVzKGNvdW50ZXJEaWN0cyk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykgewogICAgdmFyIF9PYmplY3QkZW50cmllcyRfaSA9IF9zbGljZWRUb0FycmF5KF9PYmplY3QkZW50cmllc1tfaV0sIDIpLAogICAgICAgIGF0dHJOYW1lID0gX09iamVjdCRlbnRyaWVzJF9pWzBdLAogICAgICAgIGF0dHJEaWN0ID0gX09iamVjdCRlbnRyaWVzJF9pWzFdOwoKICAgIHJhcml0eVNjb3JlRGljdHNbYXR0ck5hbWVdID0ge307CgogICAgZm9yICh2YXIgX2kyID0gMCwgX09iamVjdCRlbnRyaWVzMiA9IE9iamVjdC5lbnRyaWVzKGF0dHJEaWN0KTsgX2kyIDwgX09iamVjdCRlbnRyaWVzMi5sZW5ndGg7IF9pMisrKSB7CiAgICAgIHZhciBfT2JqZWN0JGVudHJpZXMyJF9pID0gX3NsaWNlZFRvQXJyYXkoX09iamVjdCRlbnRyaWVzMltfaTJdLCAyKSwKICAgICAgICAgIGF0dHJFbnRyeSA9IF9PYmplY3QkZW50cmllczIkX2lbMF0sCiAgICAgICAgICBhdHRyQ291bnQgPSBfT2JqZWN0JGVudHJpZXMyJF9pWzFdOwoKICAgICAgcmFyaXR5U2NvcmVEaWN0c1thdHRyTmFtZV1bYXR0ckVudHJ5XSA9IDEgLyAoYXR0ckNvdW50IC8gZmlsZUNvdW50KTsKICAgIH0KICB9IC8vIGNvbnNvbGUubG9nKHJhcml0eVNjb3JlRGljdHMpCgoKICByZXR1cm4gcmFyaXR5U2NvcmVEaWN0czsKfQoKZnVuY3Rpb24gcmFua0ZpbGVzQnlSYXJpdHkoZmlsZXMsIHJhcml0eURpY3RzKSB7CiAgdmFyIHNjb3JlZEZpbGVzID0gX3RvQ29uc3VtYWJsZUFycmF5KGZpbGVzKTsKCiAgdmFyIF9pdGVyYXRvcjMgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzY29yZWRGaWxlcyksCiAgICAgIF9zdGVwMzsKCiAgdHJ5IHsKICAgIGZvciAoX2l0ZXJhdG9yMy5zKCk7ICEoX3N0ZXAzID0gX2l0ZXJhdG9yMy5uKCkpLmRvbmU7KSB7CiAgICAgIHZhciBmID0gX3N0ZXAzLnZhbHVlOwogICAgICBmLnJhcml0eVNjb3JlID0gMDsKICAgICAgdmFyIGF0dHJpYnV0ZXMgPSBmLm1ldGFkYXRhRXh0ZXJuYWwuYXR0cmlidXRlczsKCiAgICAgIGlmICghdXRpbF8xLmlzSXRlcmFibGUoYXR0cmlidXRlcykpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdmFyIF9pdGVyYXRvcjUgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihhdHRyaWJ1dGVzKSwKICAgICAgICAgIF9zdGVwNTsKCiAgICAgIHRyeSB7CiAgICAgICAgZm9yIChfaXRlcmF0b3I1LnMoKTsgIShfc3RlcDUgPSBfaXRlcmF0b3I1Lm4oKSkuZG9uZTspIHsKICAgICAgICAgIHZhciBhdHRyaWJ1dGUgPSBfc3RlcDUudmFsdWU7CiAgICAgICAgICBmLnJhcml0eVNjb3JlICs9IHJhcml0eURpY3RzW2F0dHJpYnV0ZS50cmFpdF90eXBlXVthdHRyaWJ1dGUudmFsdWVdOwogICAgICAgIH0KICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgX2l0ZXJhdG9yNS5lKGVycik7CiAgICAgIH0gZmluYWxseSB7CiAgICAgICAgX2l0ZXJhdG9yNS5mKCk7CiAgICAgIH0KICAgIH0KICB9IGNhdGNoIChlcnIpIHsKICAgIF9pdGVyYXRvcjMuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IzLmYoKTsKICB9CgogIHZhciBzb3J0ZWRTY29yZWRGaWxlcyA9IHNjb3JlZEZpbGVzLnNvcnQoZnVuY3Rpb24gKGZpcnN0LCBzZWNvbmQpIHsKICAgIHJldHVybiBzZWNvbmQucmFyaXR5U2NvcmUgLSBmaXJzdC5yYXJpdHlTY29yZTsKICB9KTsKCiAgdmFyIF9pdGVyYXRvcjQgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihzb3J0ZWRTY29yZWRGaWxlcy5lbnRyaWVzKCkpLAogICAgICBfc3RlcDQ7CgogIHRyeSB7CiAgICBmb3IgKF9pdGVyYXRvcjQucygpOyAhKF9zdGVwNCA9IF9pdGVyYXRvcjQubigpKS5kb25lOykgewogICAgICB2YXIgX3N0ZXA0JHZhbHVlID0gX3NsaWNlZFRvQXJyYXkoX3N0ZXA0LnZhbHVlLCAyKSwKICAgICAgICAgIGkgPSBfc3RlcDQkdmFsdWVbMF0sCiAgICAgICAgICBlbCA9IF9zdGVwNCR2YWx1ZVsxXTsKCiAgICAgIGVsLnJhcml0eVJhbmsgPSBpOwogICAgICBlbC5yYXJpdHlDYXRlZ29yeSA9IGFzc2lnblJhcml0eUNhdGVnb3J5KGksIGZpbGVzLmxlbmd0aCk7CiAgICB9IC8vIGNvbnNvbGUubG9nKHNvcnRlZFNjb3JlZEZpbGVzLnNwbGljZSgwLCAxMCkpCgogIH0gY2F0Y2ggKGVycikgewogICAgX2l0ZXJhdG9yNC5lKGVycik7CiAgfSBmaW5hbGx5IHsKICAgIF9pdGVyYXRvcjQuZigpOwogIH0KCiAgcmV0dXJuIHNvcnRlZFNjb3JlZEZpbGVzOwp9IC8vIHRvZG8geWVzIHRoaXMgaXMgbmFpdmUgYnV0IGZvciBjb2xsZWN0aW9ucyB3aXRoIDEwayBmaWxlcyB0aGlzIGNhbGMgaXMgZ29vZCBlbm91Z2gKCgpmdW5jdGlvbiBwcm9jZXNzUmFyaXR5KGZpbGVzKSB7CiAgdmFyIHQxID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgdmFyIGF0dHJzID0gY291bnRBdHRyaWJ1dGVzKGZpbGVzKTsKICB2YXIgdDIgPSBwZXJmb3JtYW5jZS5ub3coKTsKICB2YXIgcmFyaXR5RGljdHMgPSBjYWxjUmFyaXR5U2NvcmVzKGF0dHJzLCBmaWxlcy5sZW5ndGgpOwogIHZhciB0MyA9IHBlcmZvcm1hbmNlLm5vdygpOwogIHZhciByYW5rZWRGaWxlcyA9IHJhbmtGaWxlc0J5UmFyaXR5KGZpbGVzLCByYXJpdHlEaWN0cyk7CiAgdmFyIHQ0ID0gcGVyZm9ybWFuY2Uubm93KCk7CiAgY29uc29sZS5sb2coJ3RpbWUgdG8gY291bnQgYXR0cnMnLCAodDIgLSB0MSkgLyAxMDAwKTsKICBjb25zb2xlLmxvZygndGltZSB0byBjb3VudCByYXJpdHkgc2NvcmVzJywgKHQzIC0gdDIpIC8gMTAwMCk7CiAgY29uc29sZS5sb2coJ3RpbWUgdG8gcmFuayBmaWxlcycsICh0NCAtIHQzKSAvIDEwMDApOwogIGNvbnNvbGUubG9nKCd0aXRhbCB0aW1lJywgKHQ0IC0gdDEpIC8gMTAwMCk7CiAgcmV0dXJuIHJhbmtlZEZpbGVzOwp9CgpleHBvcnRzLnByb2Nlc3NSYXJpdHkgPSBwcm9jZXNzUmFyaXR5Ow=="},{"version":3,"sources":["/home/quantium/labs/solana-nft-python/nft-armory/src/common/rarity.ts"],"names":[],"mappings":"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","sourcesContent":["import { isIterable } from '@/common/helpers/util';\n\nfunction isPresent(dictKey: any, dict: any): boolean {\n  return dictKey in dict;\n}\n\n// may or may not resemble epicness levels in WoW:)\nexport enum RarityCategory {\n  Legendary = 'legendary',\n  Epic = 'epic',\n  Rare = 'rare',\n  Uncommon = 'uncommon',\n  Common = 'common',\n}\n\nfunction assignRarityCategory(itemRank: number, totalItems: number) {\n  const percentile = (itemRank / totalItems) * 100;\n  if (percentile <= 1) {\n    return RarityCategory.Legendary;\n  }\n  if (percentile <= 5) {\n    return RarityCategory.Epic;\n  }\n  if (percentile <= 20) {\n    return RarityCategory.Rare;\n  }\n  if (percentile <= 40) {\n    return RarityCategory.Uncommon;\n  }\n  return RarityCategory.Common;\n}\n\nfunction countAttributes(files: any[]) {\n  const counterDicts: any = {};\n  for (const f of files) {\n    const { attributes } = f.metadataExternal;\n    if (!isIterable(attributes)) {\n      continue;\n    }\n\n    for (const attribute of attributes) {\n      const dictName = attribute.trait_type;\n      const dictEntry = attribute.value;\n\n      if (isPresent(dictName, counterDicts)) {\n        if (isPresent(dictEntry, counterDicts[dictName])) {\n          counterDicts[dictName][dictEntry] += 1;\n        } else {\n          counterDicts[dictName][dictEntry] = 1;\n        }\n      } else {\n        counterDicts[dictName] = {};\n        counterDicts[dictName][dictEntry] = 1;\n      }\n    }\n  }\n  // console.log(counterDicts)\n  return counterDicts;\n}\n\nfunction calcRarityScores(counterDicts: any, fileCount: number) {\n  console.log('length is', fileCount);\n  const rarityScoreDicts: any = {};\n  for (const [attrName, attrDict] of Object.entries(counterDicts)) {\n    rarityScoreDicts[attrName] = {};\n    for (const [attrEntry, attrCount] of Object.entries(attrDict as any)) {\n      rarityScoreDicts[attrName][attrEntry] = 1 / ((attrCount as any) / fileCount);\n    }\n  }\n  // console.log(rarityScoreDicts)\n  return rarityScoreDicts;\n}\n\nfunction rankFilesByRarity(files: any[], rarityDicts: any) {\n  const scoredFiles = [...files];\n  for (const f of scoredFiles) {\n    f.rarityScore = 0;\n    const { attributes } = f.metadataExternal;\n    if (!isIterable(attributes)) {\n      continue;\n    }\n\n    for (const attribute of attributes) {\n      f.rarityScore += rarityDicts[attribute.trait_type][attribute.value];\n    }\n  }\n  const sortedScoredFiles = scoredFiles.sort(\n    (first, second) => second.rarityScore - first.rarityScore\n  );\n  for (const [i, el] of sortedScoredFiles.entries()) {\n    el.rarityRank = i;\n    el.rarityCategory = assignRarityCategory(i, files.length);\n  }\n  // console.log(sortedScoredFiles.splice(0, 10))\n  return sortedScoredFiles;\n}\n\n// todo yes this is naive but for collections with 10k files this calc is good enough\nexport function processRarity(files: any[]) {\n  const t1 = performance.now();\n\n  const attrs = countAttributes(files);\n  const t2 = performance.now();\n\n  const rarityDicts = calcRarityScores(attrs, files.length);\n  const t3 = performance.now();\n\n  const rankedFiles = rankFilesByRarity(files, rarityDicts);\n  const t4 = performance.now();\n\n  console.log('time to count attrs', (t2 - t1) / 1000);\n  console.log('time to count rarity scores', (t3 - t2) / 1000);\n  console.log('time to rank files', (t4 - t3) / 1000);\n  console.log('tital time', (t4 - t1) / 1000);\n\n  return rankedFiles;\n}\n"],"sourceRoot":""}]}